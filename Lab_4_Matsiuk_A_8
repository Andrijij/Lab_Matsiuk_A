import numpy as np
import matplotlib.pyplot as plt
from sklearn.cluster import KMeans
from sklearn.metrics import silhouette_score

# Значення для варіанту 14 задача 8
a, b, c, d = 2, 0, 3, 1
s = 0.5

# Генерація даних
x0 = np.hstack([np.random.normal(a, s, 10), np.random.normal(b, s, 10)])
x1 = np.hstack([np.random.normal(c, s, 10), np.random.normal(d, s, 10)])
x = np.vstack([x0, x1]).T

# Кластеризація з використанням KMeans
kmeans = KMeans(n_clusters=2, random_state=42)
kmeans.fit(x)
labels = kmeans.labels_

# Оцінка якості кластеризації (індекс силуету)
silhouette_avg = silhouette_score(x, labels)
print(f"Середній індекс силуету: {silhouette_avg}")

# Прогноз для довільної точки (наприклад, [1.5, 1.0])
point = np.array([[1.5, 1.0]])
predicted_cluster = kmeans.predict(point)
print(f"Точка {point} відноситься до кластера: {predicted_cluster[0]}")

# Графік з точками даних і мітками кластерів
plt.scatter(x[:, 0], x[:, 1], c=labels, cmap='viridis', label='Точки даних')
plt.scatter(point[0, 0], point[0, 1], color='red', label='Довільна точка (1.5, 1.0)', marker='x', s=100)
plt.title('Кластеризація даних')
plt.xlabel('x0')
plt.ylabel('x1')
plt.legend()
plt.show()
